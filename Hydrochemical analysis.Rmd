---
title: "Hydrochemical analysis of mid-low sections from North Patagonia Rivers, Argentina (2014-2015)"
author: "VÃ©lez-Agudelo Camilo"
date: "18/2/2021"
output:
 html_document:
     toc: TRUE
     toc_float: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = TRUE, echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(kableExtra)
library(gridExtra)
library(rstatix)
```

# **Exploratory Data Analysis** #

## Complete Data ##

These data base include measurements of summer and winter, as well as the coastal and continental sites

```{r }
varam <- readRDS("data.rds") ##original data##

varam.summer <- varam %>% 
    filter(Season == "summer") ##summer data##

varam.winter <- varam %>% 
    filter(Season == "winter")##winter data##
    
```


```{r echo = FALSE}
varam %>% 
    kable(caption = "Hidrochemical data (summer and winter) from Northen Patagonia River") %>%
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")
```


```{r echo = FALSE}
summary.sta <- pastecs::stat.desc(
    varam[,c(4:19)], 
    )

summary.sta <- round(
    summary.sta, 2
    )

summary.sta %>% 
    kable(caption = "Statistical summary of physical and chemical variables (complete data)",
          align = "cccccccccccccccc") %>% 
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")

```

### Histogram density plots ###

```{r echo = FALSE, fig.width=12, fig.height=8}

p1 <- ggplot (
  data = varam,
  aes(x = pH)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = 8.656526), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "pH", 
    y = "Density"
    ) +
  theme_minimal()

p2 <- ggplot (
  data = varam,
  aes(x = Conductivity)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = 2.678842), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Conductivity", 
    y = "Density"
    ) +
  theme_minimal()

p3 <- ggplot (
  data = varam,
  aes(x = Temperature)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Temperature, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Temperature", 
    y = "Density"
    ) +
  theme_minimal()

p4 <- ggplot (
  data = varam,
  aes(x = Salinity)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Salinity, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Salinity", 
    y = "Density"
    ) +
  theme_minimal()

p5 <- ggplot (
  data = varam,
  aes(x = HCO3)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$HCO3, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Bicarbonates", 
    y = "Density"
    ) +
  theme_minimal()

p6 <- ggplot (
  data = varam,
  aes(x = Cl)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Cl, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Chlorine", 
    y = "Density"
    ) +
  theme_minimal()

p7 <- ggplot (
  data = varam,
  aes(x = Hardness)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Hardness, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Hardness", 
    y = "Density"
    ) +
  theme_minimal()

p8 <- ggplot (
  data = varam,
  aes(x = Ca)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Ca, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Calcium", 
    y = "Density"
    ) +
  theme_minimal()

p9 <- ggplot (
  data = varam,
  aes(x = Mg)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Mg, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Magnesium", 
    y = "Density"
    ) +
  theme_minimal()

p10 <- ggplot (
  data = varam,
  aes(x = SO4)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$SO4, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Sulphate", 
    y = "Density"
    ) +
  theme_minimal()

p11 <- ggplot (
  data = varam,
  aes(x = Na)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Na, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Sodium", 
    y = "Density"
    ) +
  theme_minimal()

p12 <- ggplot (
  data = varam,
  aes(x = K)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$K, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Potassium", 
    y = "Density"
    ) +
  theme_minimal()

p13 <- ggplot (
  data = varam,
  aes(x = SiO2)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$SiO2, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Silica", 
    y = "Density"
    ) +
  theme_minimal()

p14 <- ggplot (
  data = varam,
  aes(x = NO3)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$NO3, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Nitrates", 
    y = "Density"
    ) +
  theme_minimal()

grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, nrow = 5, ncol = 3)

```



### Bean Plot - Complete Data ###

Beanplots of physical and hydrochemical variables measured in the Colorado, Negro and Chubut Rivers. The dotted line is the overall mean for each variables while the solid line indicates the mean value in each season.

```{r echo = FALSE, fig.width = 10, fig.height = 6}

library(beanplot)

par(
    mar=c(2,2,2,2), 
    mfcol=c(3,5)
    )

beanplot(
    Temperature ~ Season*River,
    data = varam,
    bw = "nrd0",
    ll = 0.1,
    col = list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Temperature",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Conductivity ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Conductivity",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    pH ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="pH",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Salinity ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Salinity",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    HCO3 ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Bicarbonates",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Cl ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Chloride",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Hardness ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Hardness",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Ca ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Calcium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Mg ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Magnesium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    SO4 ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Sulphate",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Na ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Sodium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    K ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Potassium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )
legend(
    "right",
    fill=c("deepskyblue3","darkorange2"),
    legend=c("Winter","Summer"),
    bty="n",
    ncol=1
    )

beanplot(
    SiO2 ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Silica",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    NO3 ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Nitrate",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

```

### Bean Plot - In Inland Areas ###

The estuarine sites were removed from these graphics.

```{r echo = TRUE}

varam.inland <- varam[-c(1:6, 31:36, 67:75),]

```

```{r echo = FALSE, fig.width = 10, fig.height = 6}

par(
    mar=c(2,2,2,2), 
    mfcol=c(3,5)
    )

beanplot(
    Temperature ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Temperature",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Conductivity ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Conductivity",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    pH ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="pH",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Salinity ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Salinity",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    HCO3 ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Bicarbonates",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Cl ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Chloride",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Hardness ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Hardness",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Ca ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Calcium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Mg ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Magnesium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    SO4 ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Sulphate",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Na ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Sodium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    K ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Potassium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )
legend(
    "right",
    fill=c("deepskyblue3","darkorange2"),
    legend=c("Winter","Summer"),
    bty="n",
    ncol=1
    )

beanplot(
    SiO2 ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Silica",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    NO3 ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Nitrate",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )
```


### Correlation Analysis - Complete Data ###




### Summer Data ##

These data include only the summer measurements doing in the three rivers.

```{r echo = FALSE}

summary.summer <- pastecs::stat.desc(
    varam.summer[,c(4:19)], 
    )

summary.summer <- round(
    summary.summer, 2
    )

summary.summer %>% 
    kable(caption = "Statistical summary of physical and chemical variables measured in summer",
          align = "cccccccccccccccc") %>% 
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")
```


