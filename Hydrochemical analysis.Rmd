---
title: "Hydrochemical analysis of mid-low sections from North Patagonia Rivers, Argentina (2014-2015)"
author: "VÃ©lez-Agudelo Camilo"
date: "18/2/2021"
output:
 html_document:
     toc: TRUE
     toc_float: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = TRUE, echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(kableExtra)
library(gridExtra)
library(rstatix)
```

```{r theme_elegante, echo = FALSE}

theme_elegante <- function(base_size = 15,
                           base_family = "Raleway"
)
{
  color.background = "#FFFFFF" # Chart Background
  color.grid.major = "#D9D9D9" # Chart Gridlines
  color.axis.text = "#666666" # 
  color.axis.title = "#666666" # 
  color.title = "#666666"
  color.subtitle = "#666666"
  strip.background.color = '#9999CC'
  
  ret <-
    theme_bw(base_size=base_size) +
    
    # Set the entire chart region to a light gray color
    theme(panel.background=element_rect(fill=color.background, color=color.background)) +
    theme(plot.background=element_rect(fill=color.background, color=color.background)) +
    theme(panel.border=element_rect(color=color.background)) +
    
    # Format the grid
    theme(panel.grid.major=element_line(color=color.grid.major,size=.55, linetype="dotted")) +
    theme(panel.grid.minor=element_line(color=color.grid.major,size=.55, linetype="dotted")) +
    theme(axis.ticks=element_blank()) +
    
    # Format the legend, but hide by default
    theme(legend.position="none") +
    theme(legend.background = element_rect(fill=color.background)) +
    theme(legend.text = element_text(size=base_size-3,color=color.axis.title, family = base_family)) +
    
    theme(strip.text.x = element_text(size=base_size,color=color.background, family = base_family)) +
    theme(strip.text.y = element_text(size=base_size,color=color.background, family = base_family)) +
    #theme(strip.background = element_rect(fill=strip.background.color, linetype="blank")) +
    theme(strip.background = element_rect(fill = "grey70", colour = NA)) +
    # theme(panel.border= element_rect(fill = NA, colour = "grey70", size = rel(1)))+
    # Set title and axis labels, and format these and tick marks
    theme(plot.title=element_text(color=color.title, 
                                  size=25, 
                                  vjust=1.25, 
                                  family=base_family, 
                                  hjust = 0.5
    )) +
    
    theme(plot.subtitle=element_text(color=color.subtitle, size=base_size+2, family = base_family,  hjust = 0.5))  +
    
    theme(axis.text.x=element_text(size=base_size,color=color.axis.text, family = base_family)) +
    theme(axis.text.y=element_text(size=base_size,color=color.axis.text, family = base_family)) +
    theme(text=element_text(size=base_size, color=color.axis.text, family = base_family)) +
    
    theme(axis.title.x=element_text(size=base_size+2,color=color.axis.title, vjust=0, family = base_family)) +
    theme(axis.title.y=element_text(size=base_size+2,color=color.axis.title, vjust=1.25, family = base_family)) +
    theme(plot.caption=element_text(size=base_size-2,color=color.axis.title, vjust=1.25, family = base_family)) +
    
    # Legend  
    theme(legend.text=element_text(size=base_size,color=color.axis.text, family = base_family)) +
    theme(legend.title=element_text(size=base_size,color=color.axis.text, family = base_family)) +
    theme(legend.key=element_rect(colour = color.background, fill = color.background)) +
    theme(legend.position="bottom", 
          legend.box = "horizontal", 
          legend.title = element_blank(),
          legend.key.width = unit(.75, "cm"),
          legend.key.height = unit(.75, "cm"),
          legend.spacing.x = unit(.25, 'cm'),
          legend.spacing.y = unit(.25, 'cm'),
          legend.margin = margin(t=0, r=0, b=0, l=0, unit="cm")) +
    
    # Plot margins
    theme(plot.margin = unit(c(.5, .5, .5, .5), "cm"))
  
  ret
}
```

# **Exploratory Data Analysis** #

## Complete Data ##

These data base include measurements of physical and chemical variables in coastal and inlet sites of three river from Northern Patagonia, Argentina. The measurements were made in the austral summer and winter of 2014 and 2015.

```{r }
varam <- readRDS("data.rds") ##original data##
```

Code to data filtered by summer and winter

```{r Inland.data, echo = TRUE}

varam.inland <- varam[-c(1:6, 31:36, 67:76), -c(6, 7)]

varam.summer <- varam.inland %>% 
    filter(Season == "summer") ##summer data##

varam.winter <- varam.inland[-c(2, 20),] %>% 
    filter(Season == "winter")##winter data##

```


```{r Data, echo = FALSE}
varam %>% 
    kable(caption = "Physical and hidrochemical data (summer and winter) from Northen Patagonia River") %>%
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")
```


```{r Statistical.summary, echo = FALSE}
summary.sta <- pastecs::stat.desc(
    varam[,c(4:19)], 
    )

summary.sta <- round(
    summary.sta, 2
    )

summary.sta %>% 
    kable(caption = "Statistical summary of physical and chemical variables (complete data)",
          align = "cccccccccccccccc") %>% 
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")

```

### Histogram density plots ###

```{r Histrogram.density, echo = FALSE, fig.width=12, fig.height=8}

p1 <- ggplot (
  data = varam,
  aes(x = pH)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = 8.656526), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "pH", 
    y = "Density"
    ) +
  theme_elegante()

p2 <- ggplot (
  data = varam,
  aes(x = Conductivity)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = 2.678842), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Conductivity", 
    y = "Density"
    ) +
  theme_minimal()

p3 <- ggplot (
  data = varam,
  aes(x = Temperature)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Temperature, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Temperature", 
    y = "Density"
    ) +
  theme_minimal()

p4 <- ggplot (
  data = varam,
  aes(x = Salinity)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Salinity, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Salinity", 
    y = "Density"
    ) +
  theme_minimal()

p5 <- ggplot (
  data = varam,
  aes(x = HCO3)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$HCO3, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Bicarbonates", 
    y = "Density"
    ) +
  theme_minimal()

p6 <- ggplot (
  data = varam,
  aes(x = Cl)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Cl, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Chlorine", 
    y = "Density"
    ) +
  theme_minimal()

p7 <- ggplot (
  data = varam,
  aes(x = Hardness)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Hardness, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Hardness", 
    y = "Density"
    ) +
  theme_minimal()

p8 <- ggplot (
  data = varam,
  aes(x = Ca)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Ca, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Calcium", 
    y = "Density"
    ) +
  theme_minimal()

p9 <- ggplot (
  data = varam,
  aes(x = Mg)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Mg, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Magnesium", 
    y = "Density"
    ) +
  theme_minimal()

p10 <- ggplot (
  data = varam,
  aes(x = SO4)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$SO4, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Sulphate", 
    y = "Density"
    ) +
  theme_minimal()

p11 <- ggplot (
  data = varam,
  aes(x = Na)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$Na, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Sodium", 
    y = "Density"
    ) +
  theme_minimal()

p12 <- ggplot (
  data = varam,
  aes(x = K)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$K, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Potassium", 
    y = "Density"
    ) +
  theme_minimal()

p13 <- ggplot (
  data = varam,
  aes(x = SiO2)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$SiO2, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Silica", 
    y = "Density"
    ) +
  theme_minimal()

p14 <- ggplot (
  data = varam,
  aes(x = NO3)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_vline(
    aes(xintercept = mean(varam$NO3, na.rm = T)), 
    color = "blue",  
    linetype = "dashed", 
    size = 1, 
    na.rm=TRUE
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Nitrates", 
    y = "Density"
    ) +
  theme_minimal()

grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, nrow = 5, ncol = 3)

```

### Bean Plot ###

Beanplots of physical and hydrochemical variables measured in the Colorado, Negro and Chubut Rivers. The dotted line is the overall mean for each variables while the solid line indicates the mean value in each season.

```{r Beanplots, echo = FALSE, fig.width = 10, fig.height = 6}

library(beanplot)

par(
    mar=c(2,2,2,2), 
    mfcol=c(3,5)
    )

beanplot(
    Temperature ~ Season*River,
    data = varam,
    bw = "nrd0",
    ll = 0.1,
    col = list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Temperature",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Conductivity ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Conductivity",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    pH ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="pH",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Salinity ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Salinity",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    HCO3 ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Bicarbonates",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Cl ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Chloride",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Hardness ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Hardness",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Ca ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Calcium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Mg ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Magnesium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    SO4 ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Sulphate",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Na ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Sodium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    K ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Potassium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )
legend(
    "right",
    fill=c("deepskyblue3","darkorange2"),
    legend=c("Winter","Summer"),
    bty="n",
    ncol=1
    )

beanplot(
    SiO2 ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Silica",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    NO3 ~ Season*River,
    data=varam,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Nitrate",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

```


## Inland Areas ##

These data base include measurements of summer and winter taken in inland areas (to reduce the salinity effect the estuarine sites were remove from these analysis)

### Summary Summer Data ###

These data include only the summer measurements doing in the three rivers.

```{r echo = FALSE}

summary.summer <- pastecs::stat.desc(
    varam.summer[, c(4:17)], 
    )

summary.summer <- round(
    summary.summer, 2
    )

summary.summer %>% 
    kable(caption = "Statistical summary of physical and chemical variables measured in summer",
          align = "cccccccccccccc") %>% 
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")
```

Data transformed code:

```{r summer.data.transformed}

##As squared root##
varam.summer.sqrt <- apply(
  varam.summer[,-c(1:3)], 
  2, 
  sqrt
  )

varam.summer.sqrt <- as.data.frame(varam.summer.sqrt)
varam.summer.sqrt <- cbind(
  varam.summer[,c(1:3)],
  round(varam.summer.sqrt, digits = 2)
  )


##As logarithm except pH##
varam.summer.log <- apply(
  varam.summer[,-c(1:4)], 
  2, 
  log1p
  )

varam.summer.log <- as.data.frame(varam.summer.log)
varam.summer.log <- cbind(
  varam.summer[,c(1:4)],
  round(varam.summer.log, digits = 2)
  )

```


### Summary Winter Data ###

These data include only the winter measurements doing in the three rivers.

```{r echo = FALSE}

summary.winter <- pastecs::stat.desc(
    varam.winter[, c(4:17)], 
    )

summary.winter <- round(
    summary.winter, 2
    )

summary.winter %>% 
    kable(caption = "Statistical summary of physical and chemical variables measured in winter",
          align = "cccccccccccccc") %>% 
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")
```


Data transformed code:


```{r winter.data.transformed}

##As squared root##
varam.winter.sqrt <- apply(
  varam.winter[,-c(1:3)], 
  2, 
  sqrt
  )

varam.winter.sqrt <- as.data.frame(varam.winter.sqrt)
varam.winter.sqrt <- cbind(
  varam.winter[,c(1:3)],
  round(varam.winter.sqrt, digits = 2)
  )


##As logarithm except pH##
varam.winter.log <- apply(
  varam.winter[,-c(1:4)], 
  2, 
  log1p
  )

varam.winter.log <- as.data.frame(varam.winter.log)
varam.winter.log <- cbind(
  varam.winter[,c(1:4)],
  round(varam.winter.log, digits = 2)
  )

```


### Bean Plots ###

```{r Beanplot.Inland, echo = FALSE, fig.width = 10, fig.height = 6}

par(
    mar=c(2,2,2,2), 
    mfcol=c(3,5)
    )

beanplot(
    Temperature ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Temperature",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Conductivity ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Conductivity",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    pH ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="pH",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Salinity ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Salinity",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    HCO3 ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Bicarbonates",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Cl ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Chloride",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Hardness ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Hardness",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Ca ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Calcium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Mg ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Magnesium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    SO4 ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Sulphate",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    Na ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Sodium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    K ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Potassium",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )
legend(
    "right",
    fill=c("deepskyblue3","darkorange2"),
    legend=c("Winter","Summer"),
    bty="n",
    ncol=1
    )

beanplot(
    SiO2 ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Silica",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )

beanplot(
    NO3 ~ Season*River,
    data=varam.inland,
    bw="nrd0",
    ll=0.1,
    col=list("deepskyblue3",c("darkorange2","black")),
    horizontal=F,
    main="Nitrate",
    log="",
    side="both",
    beanlines="mean",
    show.names=T,
    innerborder=NA
    )
```


# **Multinormality Test** #

## Complete Data ##

Data transformed code:

```{r Data.transformed}

##As squared root##
varam.sqrt <- apply(
  varam[complete.cases(varam), -c(1:3, 6:7)], 
  2, 
  sqrt
  )

varam.sqrt <- as.data.frame(varam.sqrt)
varam.sqrt <- cbind(
  varam[complete.cases(varam), c(1:3)],
  round(varam.sqrt, digits = 2)
  )


##As logarithm except pH##
varam.log <- apply(
  varam[complete.cases(varam), -c(1:4, 6:7)], 
  2, 
  log1p
  )

varam.log <- as.data.frame(varam.log)
varam.log <- cbind(
  varam[complete.cases(varam), c(1:4)],
  round(varam.log, digits = 2)
  )

```

Multivariate normality Q-Q plots and distribution of data trasformed: according to Shapiro-Wilk test, multinormality in all cases (untransformed and transformed data) can't be assumed. The p-value is greater than 0.05, hence the distribution of the given data is different from normal distribution significantly.

<div class = "row">
<div class = "col-md-6">
```{r QQplot.untrans, echo = FALSE, fig.height = 10, fig.width = 14}
multi.test1 <- rstatix::mshapiro_test(
    varam[complete.cases(varam),-c(1:3, 6:7)])


RVAideMemoire::mqqnorm(
    varam[complete.cases(varam),-c(1:3, 6:7)], 
    main = expression(paste("Multinormal Q-Q plot for complete data untransformed - Shapiro test: p value = 7x10" ^-21)))
```
</div>

<div class = "col-md-6">
```{r Hist.untrans, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large1 <- gather(
    data = varam,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season, Turbidity, D.Oxygen))


ggplot (
  data = varam.large1,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    y = "Density"
    ) +
  theme_elegante()

```
</div>
</div>


<div class = "row">
<div class = "col-md-6">
```{r QQplot.sqrt, echo = FALSE, fig.height = 10, fig.width = 14}
multi.test2 <- rstatix::mshapiro_test(
    varam.sqrt[,-c(1:3)])


RVAideMemoire::mqqnorm(
    varam.sqrt[,-c(1:3)], 
    main = expression(paste("Multinormal Q-Q plot for complete data square root-transformed - Shapiro test: p value = 1.0x10" ^-17)))
```
</div>

<div class = "col-md-6">
```{r Hist.sqrt, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large2 <- gather(
    data = varam.sqrt,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season)
    )

ggplot (
  data = varam.large2,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Square-root transformed data",
    y = "Density"
    ) +
  theme_elegante()

```
</div>
</div>


<div class = "row">
<div class = "col-md-6">
```{r QQplot.log, echo = FALSE, fig.height = 10, fig.width = 14}
multi.test3 <- rstatix::mshapiro_test(
    varam.log[,-c(1:3)])


RVAideMemoire::mqqnorm(
    varam.log[,-c(1:3)], 
    main = expression(paste("Multinormal Q-Q plot for complete data log-transformed - Shapiro test: p value = 8.3x10" ^-15)))
```
</div>

<div class = "col-md-6">
```{r Hist.log, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large3 <- gather(
    data = varam.log,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season)
    )

ggplot (
  data = varam.large3,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Log-transformed data",
    y = "Density"
    ) +
  theme_elegante()

```
</div>
</div>


## Inland Summer Data ###

```{r test.summer.inland, echo = FALSE, fig.height = 6, fig.width = 10}

multi.test4 <- rstatix::mshapiro_test(
    varam.summer[,-c(1:3)])


RVAideMemoire::mqqnorm(
    varam.summer[,-c(1:3)], 
    main = expression(paste("Multinormal Q-Q plot for inland summer data untransformed - Shapiro test: p value = 5.7x10" ^-12)))
```


```{r Hist.summer.inland, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large4 <- gather(
    data = varam.summer,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season)
    )

ggplot (
  data = varam.large4,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Data Untransformed",
    y = "Density",
    title = "Inland Sites - Summer"
    ) +
  theme_elegante()

```

```{r test.summer.sqrt.inland, echo = FALSE, fig.height = 6, fig.width = 10}

multi.test5 <- rstatix::mshapiro_test(
    varam.summer.sqrt[,-c(1:3)])


RVAideMemoire::mqqnorm(
    varam.summer.sqrt[,-c(1:3)], 
    main = expression(paste("Multinormal Q-Q plot for inland summer data square-root transformed - Shapiro test: p value = 3.4x10" ^-11)))
```


```{r Hist.summer.sqrt.inland, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large5 <- gather(
    data = varam.summer.sqrt,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season)
    )

ggplot (
  data = varam.large5,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Square-root transformed",
    y = "Density",
    title = "Inland Sites - Summer"
    ) +
  theme_elegante()

```


```{r test.summer.log.inland, echo = FALSE, fig.height = 6, fig.width = 10}

multi.test6 <- rstatix::mshapiro_test(
    varam.summer.log[,-c(1:3)])


RVAideMemoire::mqqnorm(
    varam.summer.log[,-c(1:3)], 
    main = expression(paste("Multinormal Q-Q plot for inland summer data Log-transformed - Shapiro test: p value = 3.4x10" ^-11)))
```


```{r Hist.summer.log.inland, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large6 <- gather(
    data = varam.summer.log,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season)
    )

ggplot (
  data = varam.large6,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Log-transformed",
    y = "Density",
    title = "Inland Sites - Summer"
    ) +
  theme_elegante()

```

## Inland Winter Data ##

```{r test.winter.inland, echo = FALSE, fig.height = 6, fig.width = 10}

multi.test7 <- rstatix::mshapiro_test(
    varam.winter[,-c(1:3)])


RVAideMemoire::mqqnorm(
    varam.winter[,-c(1:3)], 
    main = expression(paste("Multinormal Q-Q plot for inland winter data untransformed - Shapiro test: p value = 7.9x10" ^-12)))
```

```{r Hist.winter.inland, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large7 <- gather(
    data = varam.winter,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season)
    )

ggplot (
  data = varam.large7,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Data Untransformed",
    y = "Density",
    title = "Inland Sites - Winter"
    ) +
  theme_elegante()

```

```{r test.winter.sqrt.inland, echo = FALSE, fig.height = 6, fig.width = 10}

multi.test8 <- rstatix::mshapiro_test(
    varam.winter.sqrt[,-c(1:3)])


RVAideMemoire::mqqnorm(
    varam.winter.sqrt[,-c(1:3)], 
    main = expression(paste("Multinormal Q-Q plot for inland winter data square-root transformed - Shapiro test: p value = 1.4x10" ^-9)))
```

```{r Hist.winter.sqrt.inland, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large8 <- gather(
    data = varam.winter.sqrt,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season)
    )

ggplot (
  data = varam.large8,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Square-root transformed",
    y = "Density",
    title = "Inland Sites - winter"
    ) +
  theme_elegante()

```

```{r test.winter.log.inland, echo = FALSE, fig.height = 6, fig.width = 10}

multi.test9 <- rstatix::mshapiro_test(
    varam.winter.log[,-c(1:3)])


RVAideMemoire::mqqnorm(
    varam.winter.log[,-c(1:3)], 
    main = expression(paste("Multinormal Q-Q plot for inland winter data Log-transformed - Shapiro test: p value = 7.9x10" ^-8)))
```

```{r Hist.winter.log.inland, echo = FALSE, fig.height = 10, fig.width = 14}

varam.large9 <- gather(
    data = varam.winter.log,
    key = "Variable",
    value = "Value",
    -c(River, Site, Season)
    )

ggplot (
  data = varam.large9,
  aes(x = Value)
  ) +
  geom_histogram(
    aes(y = ..density..), 
    colour = "#E69F00", 
    fill = "white", 
    size = 0.9
    ) +
  geom_density(
    colour= "#E69F00", 
    fill="#E69F00",
    alpha=0.6, 
    size = 0.5
    ) +
  labs(
    x = "Log-transformed",
    y = "Density",
    title = "Inland Sites - winter"
    ) +
  theme_elegante()

```

# **Correlation Analysis** #

## Inland Summer Data ##

```{r correlation.summer, echo = FALSE, fig.width = 10, fig.height = 8}

library(ggpubr)
library(Hmisc)
library(corrplot)

col <- colorRampPalette(c("darkorange", "white", "steelblue4"))(20)

pvalue.summer <- rcorr(
  as.matrix(varam.summer[,-c(1:3)]), 
  type="spearman"
  )

M.summer <- pvalue.summer$r

p_mat.summer <- pvalue.summer$P

corrplot(M.summer,
         type = "upper",
         order = "hclust",
         col = col,
         bg = "palegreen",
         tl.col = "black",
         tl.srt = 45,
         p.mat = p_mat.summer,
         sig.level = 0.05
         )

```

```{r echo = FALSE, fig.align = "center", fig.width = 10, fig.height = 12}

library(GGally)

ggpairs(
  data = varam.summer[, -c(1:3)],
  lower = list(continuous = wrap("smooth", pch = 16, alpha = 0.3, color = "darkorchid4")),
  diag = list(continuous = wrap("barDiag", color = "white", fill = "#E69F00")), 
  axisLabels = "none",
  title = "Correlation Matrix for Inland Summer Data"
  ) +
  theme_bw()

```

## Inland Winter Data ##

```{r correlation.winter, echo = FALSE, fig.width = 10, fig.height = 8}

library(ggpubr)
library(Hmisc)
library(corrplot)

col <- colorRampPalette(c("darkorange", "white", "steelblue4"))(20)

pvalue.winter <- rcorr(
  as.matrix(varam.winter[,-c(1:3)]), 
  type="spearman"
  )

M.winter <- pvalue.winter$r

p_mat.winter <- pvalue.winter$P

corrplot(M.winter,
         type = "upper",
         order = "hclust",
         col = col,
         bg = "palegreen",
         tl.col = "black",
         tl.srt = 45,
         p.mat = p_mat.winter,
         sig.level = 0.05
         )

```


```{r echo = FALSE, fig.align = "center", fig.width = 10, fig.height = 12}

library(GGally)

ggpairs(
  data = varam.winter[, -c(1:3)],
  lower = list(continuous = wrap("smooth", pch = 16, alpha = 0.3, color = "darkorchid4")),
  diag = list(continuous = wrap("barDiag", color = "white", fill = "#E69F00")), 
  axisLabels = "none",
  title = "Correlation Matrix for Inland Winter Data"
  ) +
  theme_bw()

```

# **Kruskal-Wallis and Dunn's Test** ##

## Inland Summer Data ##

```{r Kruskal-Wallis.summer.inland, echo = FALSE}

dunn.summer <- varam.summer %>% 
  gather("Variable", "Value", -c(River, Site, Season)) %>% 
  group_by(Variable) %>% 
  dunn_test(formula = Value ~ River, p.adjust.method = "bonferroni")

dunn.summer %>% 
    kable(caption = "Results of the Kruskal-Wallis and Dunn's multiple comparisons test among rivers in relation to the physical and hydrochemical variables measured in inland sites during summer. In addition, see beanplots for inland summer data",
          align = "lccccccccc") %>% 
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")

```

## Inland Winter Data ##

```{r Kruskal-Wallis.winter.inland, echo = FALSE}

dunn.winter <- varam.winter %>% 
  gather("Variable", "Value", -c(River, Site, Season)) %>% 
  group_by(Variable) %>% 
  dunn_test(formula = Value ~ River, p.adjust.method = "bonferroni")

dunn.winter %>% 
    kable(caption = "Results of the Kruskal-Wallis and Dunn's multiple comparisons test among rivers in relation to the physical and hydrochemical variables measured in inland sites during winter. In addition, see beanplot for inlanda winter data",
          align = "lccccccccc") %>% 
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                  font_size = 11,
                  position = "center",
                  full_width = T) %>%
    scroll_box(height = "300px", width = "900px")

```


# **Ordination Analysis ** #

```{r pca.summer.complete, echo = F, fig.width=10, fig.height=6}

library(devtools)
library(ggbiplot)

varam.summer.complet <- varam %>% filter(Season == "summer" )

varam.pca.summer <- prcomp(
  varam.summer.complet[, -c(1:3)], 
  scale. = T
  )


p15 <- ggbiplot(
  varam.pca.summer, scale = 1, 
  obs.scale = 1, 
  var.scale = 1, 
  labels = varam.summer.complet$Site, 
  labels.size = 2.5,
  groups = varam.summer.complet$River, 
  ellipse = F, 
  circle = F
  ) +
  scale_color_discrete(name = "") +
  geom_point(
    aes(colour = varam.summer.complet$River),
    size = 2
    ) +
  labs(
    title = "PCA Summer Data Complete"
  ) +
  theme(
    legend.direction = "horizontal", 
    legend.position = "top"
    ) +
  theme_elegante()

p15

```

```{r pca.winter.complet, echo = FALSE, fig.width=10, fig.height=6}

varam.winter.complet <- varam %>% filter(Season == "winter")

varam.winter.complet <- varam.winter.complet[complete.cases(varam.winter.complet),]

varam.pca.winter <- prcomp(
  varam.winter.complet[, -c(1:3)], 
  scale. = T
  )


p16 <- ggbiplot(
  varam.pca.winter, scale = 1, 
  obs.scale = 1, 
  var.scale = 1, 
  labels = varam.winter.complet$Site, 
  labels.size = 2.5,
  groups = varam.winter.complet$River, 
  ellipse = F, 
  circle = F
  ) +
  scale_color_discrete(name = "") +
  geom_point(
    aes(colour = varam.winter.complet$River),
    size = 2
    ) +
  labs(
    title = "PCA Winter Data Complete"
  ) +
  theme(
    legend.direction = "horizontal", 
    legend.position = "top"
    ) +
  theme_elegante()

p16
```

```{r pca.summer.inlet, echo = FALSE, fig.width=10, fig.height=6}

varam.pca.summer.inlet <- prcomp(
  varam.summer[, -c(1:3)], 
  scale. = T
  )


p17 <- ggbiplot(
  varam.pca.summer.inlet, scale = 1, 
  obs.scale = 1, 
  var.scale = 1, 
  labels = varam.summer$Site, 
  labels.size = 2.5,
  groups = varam.summer$River, 
  ellipse = T, 
  circle = F
  ) +
  scale_color_discrete(name = "") +
  geom_point(
    aes(colour = varam.summer$River),
    size = 2
    ) +
  labs(
    title = "PCA Inlet Summer Data"
  ) +
  theme(
    legend.direction = "horizontal", 
    legend.position = "top"
    ) +
  theme_elegante()

p17
```

```{r pca.winter.inlet, echo = FALSE, fig.width=10, fig.height=6}

varam.pca.winter.inlet <- prcomp(
  varam.winter[, -c(1:3)], 
  scale. = T
  )


p18 <- ggbiplot(
  varam.pca.winter.inlet, scale = 1, 
  obs.scale = 1, 
  var.scale = 1, 
  labels = varam.winter$Site, 
  labels.size = 2.5,
  groups = varam.winter$River, 
  ellipse = T, 
  circle = F
  ) +
  scale_color_discrete(name = "") +
  geom_point(
    aes(colour = varam.winter$River),
    size = 2
    ) +
  labs(
    title = "PCA Inlet Winter Data"
  ) +
  theme(
    legend.direction = "horizontal", 
    legend.position = "top"
    ) +
  theme_elegante()

p18
```

# **Piper Diagrams** #

```{r Piper.diagram.summer, echo = FALSE}

library(smwrGraphs)

PD.summer <- transform(
  varam.summer.complet, 
  Ca.meq = conc2meq(Ca, "calcium"),
  Mg.meq = conc2meq(Mg, "magnesium"),
  Na.meq = conc2meq(Na, "sodium"),
  K.meq = conc2meq(K, "potassium"),
  Cl.meq = conc2meq(Cl, "chloride"),
  SO4.meq = conc2meq(SO4, "sulfate"),
  HCO3.meq = conc2meq(HCO3, "bicarb")
  )                       

PD.summer$sym <- c(
  rep("circle", 3),
  rep("circle", 12),
  rep("square", 3),
  rep("square", 15),
  rep("uptri", 5),
  rep("uptri", 12)
  )


setSweave("Piper Summer", 7, 7)

AA.pl <- with(
  PD.summer, 
  piperPlot(
    Ca.meq, 
    Mg.meq, 
    (Na.meq+K.meq),
    Cl.meq, 
    HCO3.meq, 
    SO4.meq,
  Plot = list(
    name = River,
    what = "points",
    color = setColor(River),
    symbol = sym
        ),
  zCat.title = "Sodium + Potasium",
  xAn.title = "Chloride",
  yAn.title = "Bicarbonate")
  )

addExplanation(AA.pl, where="ul", title="Piper Diagram Summer Data", box.off = FALSE)

graphics.off()

```
![](C:/Users/Camilo/Documents/Principal/Gibhub/Patagonia Analysis/Hydrochemical-analysis-of-Patagonian-Rivers/Piper Summer.png)
```{r Piper.diagram.winter, echo = FALSE}

PD.winter <- transform(
  varam.winter.complet, 
  Ca.meq = conc2meq(Ca, "calcium"),
  Mg.meq = conc2meq(Mg, "magnesium"),
  Na.meq = conc2meq(Na, "sodium"),
  K.meq = conc2meq(K, "potassium"),
  Cl.meq = conc2meq(Cl, "chloride"),
  SO4.meq = conc2meq(SO4, "sulfate"),
  HCO3.meq = conc2meq(HCO3, "bicarb")
  )                       

PD.winter$sym <- c(
  rep("circle", 10),
  rep("square", 18),
  rep("uptri", 17)
  )


setSweave("Piper Winter", 7, 7)

AA.pl2 <- with(
  PD.winter, 
  piperPlot(
    Ca.meq, 
    Mg.meq, 
    (Na.meq+K.meq),
    Cl.meq, 
    HCO3.meq, 
    SO4.meq,
  Plot = list(
    name = River,
    what = "points",
    color = setColor(River),
    symbol = sym
        ),
  zCat.title = "Sodium + Potasium",
  xAn.title = "Chloride",
  yAn.title = "Bicarbonate")
  )

addExplanation(AA.pl2, where="ul", title="Piper Diagram Winter Data", box.off = FALSE)

graphics.off()

```
![](C:/Users/Camilo/Documents/Principal/Gibhub/Patagonia Analysis/Hydrochemical-analysis-of-Patagonian-Rivers/Piper Winter.png)

# **Major Ion Composition** #

Evolution of ionic content across the rivers at the inland toward the Ocean (point 1)

```{r Cation.composition, echo = FALSE, fig.width=12, fig.height=8}

varam.mean <- readRDS("varam.mean.rds")

River <- c(
  rep("Colorado", 15),
  rep("Negro", 18),
  rep("Chubut", 17)
)

varam.mean$Site <- c(
  rep(1:15),
  rep(1:18),
  rep(1:17)
)

varam.mean <- cbind(River, varam.mean)

cations <- varam.mean[, c(1, 2, 14, 11, 16)]

ggplot(
  data = cations, 
  aes(x = factor(Site), y = Na, size = Na, col = River, group = River) 
      ) +
  geom_point(
    alpha = 0.5, 
    shape = 16,
    ) +
  geom_point(
    aes(y = Ca, size = Ca, col = River), 
    alpha = 0.5, 
    shape = 16
    ) +
  geom_point(
    aes(y = Mg, size = Mg, col = River), 
    alpha = 0.5, 
    shape = 16
    ) +
  geom_line(
    aes(y = Na, color = River), 
    size = 0.6
    ) +
  geom_line(
    aes(y = Ca, color = River), 
    linetype = "longdash", 
    size = 0.6,
    ) +
  geom_line(
    aes(y = Mg, color = River), 
    linetype = "dotted", 
    size = 0.6,
    ) +
    scale_color_manual(
    values = c("blue", "red", "black")
    ) +
  scale_x_discrete(
    limits= factor(18:1)
    ) +
  labs(
    title = "Average summer-winter of cations (Na, Ca and Mg)",
    x = "Sampling sites",
    y = "Concentration (mg/L)"
    ) +
  theme_elegante()
```

```{r Anion.composition, echo = FALSE, fig.width=12, fig.height=8}

anions <- varam.mean[, c(1, 2, 9, 10)]

ggplot(
  data = anions, 
  aes(x = factor(Site), y = Cl, size = Cl, col = River, group = River) 
      ) +
  geom_point(
    alpha = 0.5, 
    shape = 16,
    ) +
  geom_point(
    aes(y = SO4, size = SO4, col = River), 
    alpha = 0.5, 
    shape = 16
    ) +
  geom_line(
    aes(y = Cl, color = River), 
    size = 0.6
    ) +
  geom_line(
    aes(y = SO4, color = River), 
    linetype = "longdash", 
    size = 0.6,
    ) +
  scale_color_manual(
    values = c("blue", "red", "black")
    ) +
  scale_x_discrete(
    limits= factor(18:1)
    ) +
  labs(
    title = "Average summer-winter of anions (Cl and SO4)",
    x = "Sampling sites",
    y = "Concentration (mg/L)"
    ) +
  theme_elegante()
```

# **Major Ionic Ratios** #

```{r Na.Cl, echo = FALSE}

p19 <- ggplot(
  data = PD.summer, 
  aes(x = Na.meq, y = Cl.meq)
  ) +
  geom_point(
    aes(col = River, shape = River, fill = River),
    size = 2, 
    show.legend = F
    ) +
  geom_point(
    data = PD.winter, 
    aes(x = Na.meq, y = Cl.meq, col = River, shape = River), 
    size = 2, 
    show.legend = F
    ) +
  scale_shape_manual(
    values = c(21, 22, 24)
    ) +
  scale_color_manual(
    values = c("darkcyan", "red", "black")
    ) +
  scale_fill_manual(
    values = c("darkcyan", "red", "black")
    ) +
  geom_abline(
    aes(intercept = 0, slope =1)
    ) +
  geom_text(
    aes(label=ifelse(Cl.meq>100,
                     as.character(Site),'')),
    hjust = 0,
    vjust = 0,
    check_overlap = T
    ) +
  geom_text(
    data = PD.winter,
    aes(label=ifelse(Cl.meq>100,
                     as.character(Site),'')),
    hjust = 0,
    vjust = 0,
    check_overlap = T
    ) +
  labs(
    y = "Cl (meq/L)", 
    x = "Na (meq/L)"
    ) +
  theme_minimal()

```

```{r HCO3SO4.Ca+Mg, echo = FALSE}

PD.summer$A <- PD.summer$HCO3.meq + PD.summer$SO4.meq #HCO3+SO4 summer
PD.winter$A <- PD.winter$HCO3.meq + PD.winter$SO4.meq #HCO3+SO4 winter

PD.summer$B <- PD.summer$Ca.meq + PD.summer$Mg.meq #Ca + Mg summer
PD.winter$B <- PD.winter$Ca.meq + PD.winter$Mg.meq #Ca + Mg summer

p20 <- ggplot(
  data = PD.summer, 
  aes(x = B, y = A)
  ) +
  geom_point(
    aes(col = River, shape = River, fill = River),
    size = 2, 
    show.legend = F
    ) +
  geom_point(
    data = PD.winter, 
    aes(x = B, y = A, col = River, shape = River), 
    size = 2, 
    show.legend = F
    ) +
  scale_shape_manual(
    values = c(21, 22, 24)
    ) +
  scale_color_manual(
    values = c("darkcyan", "red", "black")
    ) +
  scale_fill_manual(
    values = c("darkcyan", "red", "black")
    ) +
  geom_abline(
    aes(intercept = 0, slope =1)
    ) +
  geom_text(
    aes(label=ifelse(B > 30,
                     as.character(Site),'')),
    hjust = 0,
    vjust = 0,
    check_overlap = T
    ) +
  geom_text(
    data = PD.winter,
    aes(label=ifelse(A > 35,
                     as.character(Site),'')),
    hjust = 0,
    vjust = 0,
    check_overlap = T
    ) +
  xlim(0, 50) +
  labs(
    y = "HCO3+SO4 (meq/L)", 
    x = "Ca+Mg (meq/lL)"
    ) +
  theme_minimal()

```

```{r Ca.Mg, echo = FALSE}

p21 <- ggplot(
  data = PD.summer, 
  aes(x = Ca.meq, y = SO4.meq)
  ) +
  geom_point(
    aes(col = River, shape = River, fill = River),
    size = 2, 
    show.legend = F
    ) +
  geom_point(
    data = PD.winter, 
    aes(x = Ca.meq, y = SO4.meq, col = River, shape = River), 
    size = 2, 
    show.legend = F
    ) +
  scale_shape_manual(
    values = c(21, 22, 24)
    ) +
  scale_color_manual(
    values = c("darkcyan", "red", "black")
    ) +
  scale_fill_manual(
    values = c("darkcyan", "red", "black")
    ) +
  geom_abline(
    aes(intercept = 0, slope =1)
    ) +
  geom_text(
    aes(label=ifelse(SO4.meq > 15,
                     as.character(Site),'')),
    hjust = 0,
    vjust = 0,
    check_overlap = T
    ) +
  geom_text(
    data = PD.winter,
    aes(label=ifelse(SO4.meq > 15,
                     as.character(Site),'')),
    hjust = 0,
    vjust = 0,
    check_overlap = T
    ) +
  labs(
    y = "SO4 (meq/L)", 
    x = "Ca (meq/lL)"
    ) +
  theme_minimal()

```

```{r HCO3.Ca+Mg, echo = FALSE}

p22 <- ggplot(
  data = PD.summer, 
  aes(x = B, y = HCO3.meq)
  ) +
  geom_point(
    aes(col = River, shape = River, fill = River),
    size = 2, 
    show.legend = F
    ) +
  geom_point(
    data = PD.winter, 
    aes(x = B, y = HCO3.meq, col = River, shape = River), 
    size = 2, 
    show.legend = F
    ) +
  scale_shape_manual(
    values = c(21, 22, 24)
    ) +
  scale_color_manual(
    values = c("darkcyan", "red", "black")
    ) +
  scale_fill_manual(
    values = c("darkcyan", "red", "black")
    ) +
  geom_abline(
    aes(intercept = 0, slope =1)
    ) +
  xlim (0,12) + ylim (0,8) +
  labs(
    y = "HCO3 (meq/L)", 
    x = "Ca + Mg (meq/lL)"
    ) +
  theme_minimal()

```













